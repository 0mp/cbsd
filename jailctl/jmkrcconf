#!/usr/local/bin/cbsd
#v9.2.2
globalconf="${workdir}/cbsd.conf";
MYARG="jname"

[ -f ${globalconf} ] || err 1 "no such conf file";

. ${globalconf}
. ${subr}
. ${color}

[ ! -f ${sharedir}/jail-arg ] && err 1 "${GREEN}no jail-arg file${NORMAL}";
. ${sharedir}/jail-arg

MYOPTARG="$JARG mode"
MYDESC="Modify parameter for jail"
ADDHELP="mode=force for modification on the running jail\n"

. ${inventory}
. ${tools}
init $*

cat <<EOF
# DO NOT EDIT THIS FILE. PLEASE USE INSTEAD:
# cbsd jconfig jname=${jname}
EOF

for i in ${JARG}; do
    VAL=`cbsdsql local SELECT ${i} FROM jails WHERE jname=\"${jname}\"`
    [ "${VAL}" = "(null)" -o -z "${VAL}" ] && VAL=""
    echo "${i}=\"${VAL}\";"
done

#finally set jname
echo "jname=\"${jname}\""

# exit code 0 is nessesary for dot()
exit 0
