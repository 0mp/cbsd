#!/bin/sh
#v9.0.1
globalconf="${workdir}/cbsd.conf";
MYARG=""
MYOPTARG="jname"
MYDESC="Exec login into jail"

# Login by jid not supported yet

[ -f ${globalconf} ] || err 1 "no such conf file";
. ${globalconf}
. ${subr}
init $*

[ -n "$jname" ] || jname=$1

JAILRCCONF="${jailrcconfdir}/rc.conf_${jname}"

[ -f  ${JAILRCCONF} ] || err 1 "no conf rc.conf file for jail"

. ${JAILRCCONF}
eval rootdir=\"\$jail_${jname}_rootdir\"
eval baserw=\"\$jail_${jname}_baserw\"
eval data=\"\$jail_${jname}_data\"
eval hostname=\"\$jail_${jname}_hostname\"
[ $baserw -eq 1 ] && rootdir=$data

get_jid
jid=$?
[ $jid -eq 0 ] && err 1 "Not running"
/usr/sbin/jexec ${jid} login -f root
