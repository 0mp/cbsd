#!/bin/sh
#v9.0.0
globalconf="${workdir}/cbsd.conf";
MYARG="jname"
[ -f ${globalconf} ] || err 1 "no such conf file";
. ${globalconf}
. ${subr}

[ -f ${sharedir}/jail-arg ] || err 1 "no jail-arg file";
. ${sharedir}/jail-arg

MYOPTARG="$JARG mode"
#mode=quiet
MYDESC="Get info related to jail"
ADDHELP="mode=quiet - return only value, without other string\n"
init $*

[ -n "${jname}" ] || err 1 "Give me jname"

JAILRCCONF="${jailrcconfdir}/rc.conf_${jname}"
[ -f  ${JAILRCCONF} ] || err 1 "no conf rc.conf file for jail"
. ${JAILRCCONF}

ST=`cbsd jstatus jname=${jname}`
[ $? -ne 0 ] || err 1 "Jail not exist"

QUIET=0
[ "${mode}" = "quiet" ] && QUIET=1

shift
ARGS=${@}

for OID in ${ARGS}; do
    for _jarg in ${JARG}; do
	case ${OID} in
	"${_jarg}")
	    eval val=\"\$${_jarg}\"
		if [ $QUIET -eq 1 ]; then
		    echo "${val}"
		else
		    echo "${OID}: ${val}"
		fi
	    break ;;
	"${ST}")
	    if [ $QUIET -eq 1 ]; then
		echo "${ST}"
	    else
		echo "${OID}: ${ST}"
	    fi
	    break ;;
	esac
    done
done
