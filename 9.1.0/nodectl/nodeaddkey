#!/bin/sh
#v9.0.0
globalconf="${workdir}/cbsd.conf";
MYARG="md5name ip port pw"
MYOPTARG=""
MYDESC="Get rsa get from remote node"

[ -f ${globalconf} ] || err 1 "no such conf file";
. ${globalconf}
. ${subr}
init $*

LOCALKEY="${rsshdir}/${md5name}.id_rsa"
REMOTEKEY=".ssh/${md5name}.id_rsa"

cbsd cbsdsftp ${ip} ${port} ${cbsduser} ${pw} ${REMOTEKEY} ${LOCALKEY}
RESULT=$?

case ${RESULT} in
0)
    chmod 0400 ${LOCALKEY}
    err 0 "220 Key has been added succesfull."
;;
1)
    err 1 "500 Bad user or password."
;;
2)
    err 2 "No such key on remote host."
;;
*)
    err 3 "Unknown error."
;;
esac
