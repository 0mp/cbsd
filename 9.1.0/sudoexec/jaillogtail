#!/bin/sh
#v9.0.0
globalconf="${workdir}/cbsd.conf";
MYARG="jname file"
MYOPTARG="offsetfile offsetdir mode"
MYDESC="Get ascii file content by retail"

[ -f ${globalconf} ] || err 1 "no such conf file";
. ${globalconf}
. ${subr}
init $*

if [ "${mode}" = "zero" ]; then
zero=1
else
zero=0
fi

[ -z "$offsetdir"  ] && offsetdir=""

JAILRCCONF="${jailrcconfdir}/rc.conf_${jname}"
[ -f  ${JAILRCCONF} ] || err 1 "No such jail data for $jname"
. ${JAILRCCONF}

[ -n "$offsetdir" ] || offsetdir=`dirname ${file}`

if [ $zero -eq 1 ]; then
    FNAME=`basename ${file}`
    rm -f ${path}$offsetdir/${FNAME}.syncoff
fi

[ $baserw -eq 1 ] && path=$data
cbsd cbsdlogtail -d ${path}${offsetdir}/ ${path}${file}
