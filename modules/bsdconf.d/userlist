#!/bin/sh
#v10.1.3
globalconf="${workdir}/cbsd.conf";
MYARG=""
MYOPTARG="jname"
MYDESC="Show user list"

set -e
. ${globalconf}
set +e

. ${subr}
. ${strings}
init $*

#defines
_MYDIR=$(dirname `realpath $0`)
SERVICE="userlist"

check_jaildir()
{
	[ -f ${data}/etc/master.passwd -a -f ${data}/etc/passwd -a -f ${data}/etc/group ] && return 0
	return 1
}

if [ -z "${jname}" ]; then
	data=""
	exec_cmd=""
else
	. ${jrcconf}
	[ $? -eq 1 ] &&  err 1 "${MAGENTA}No such jail: ${GREEN}${jname}${NORMAL}"
	exec_cmd="/usr/sbin/jexec ${jid}"
	check_jaildir

	if [ $? -eq 1 ]; then
		echo "bad data dir"
		exit 1
	fi
fi

/usr/bin/grep -v ^# ${data}/etc/passwd |/usr/bin/awk -F":" '{print $1}'
